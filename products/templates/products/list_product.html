{% extends 'base.html' %}

{% block content %}

<!-- Main container for products -->
<div class="max-w-screen-xl mx-auto px-4 py-8">
    <div class="flex overflow-x-auto space-x-4 pb-4">
        <ul class="flex space-x-4 list-none">
            {% for prod in products %}
            <li class="relative flex-shrink-0 w-80 bg-white rounded-lg shadow-lg overflow-hidden group">
                <!-- Product Image -->
                <div class="w-full h-72 bg-gray-200 flex items-center justify-center">
                    {% if prod.photo %}
                    <img src="{{ prod.photo.url }}" alt="{{ prod.name }}" class="object-cover w-full h-full">
                    {% else %}
                    <img src="https://via.placeholder.com/300" alt="Placeholder image" class="object-cover w-full h-full">
                    {% endif %}
                </div>

                <!-- Product Info -->
                <div class="absolute bottom-0 w-full bg-white p-4 transform translate-y-full group-hover:translate-y-0 transition-transform duration-300">
                    <h3 class="text-xl font-semibold text-purple-800">{{ prod.name }}</h3>
                    <p class="text-lg text-pink-500">${{ prod.price }}</p>
                    <p class="text-sm text-gray-600">{{ prod.description }}</p>

                    <!-- Conditionally Render Button -->
                    {% if user.is_staff %}
                        <!-- Button for Admin: Add Product -->
                        <form action="{% url 'add_product' %}" method="get" class="mt-4">
                            <input type="hidden" name="product" value="{{ prod.id }}">
                            <button type="submit"
                                    class="w-full bg-green-500 text-white py-2 rounded hover:bg-green-600 focus:outline-none focus:ring focus:ring-green-300">
                                Add
                            </button>
                        </form>
                    {% else %}
                        <!-- Button for Non-Admin: Buy Product -->
                        <form action="{% url 'create_order_product' %}" method="post" class="mt-4">
                            {% csrf_token %}
                            <input type="hidden" name="product_id" value="{{ prod.id }}">
                            <label for="quantity_{{ prod.id }}" class="block text-sm text-gray-700">Quantity:</label>
                            <input type="number" id="quantity_{{ prod.id }}" name="quantity" value="1" min="1" class="w-full border rounded p-2">
                            <button type="submit"
                                    class="w-full bg-pink-500 text-white py-2 rounded hover:bg-pink-600 focus:outline-none focus:ring focus:ring-pink-300 mt-2">
                                Buy
                            </button>
                        </form>
                    {% endif %}
                </div>
            </li>
            {% endfor %}
        </ul>
    </div>
</div>

{% endblock %}
